---
title: "CleanCode 5. 형식 맞추기"
categories:
  - CleanCode
read_time: false
tags:
  - CleanCode
comments:
  - true
toc: true
toc_sticky: true
---
> 이 포스팅은 로버트 C.마틴의 클린코드를 읽은 후 작성하였습니다.

## 들어가기 전
* 이번 형식 맞추기 파트를 읽으며, 가독성 측면에서도 중요한 파트지만, 협업에 있어서도 굉장히 중요한 파트라는 것을 느끼게 되었다.
* 협업을 하며, 서로 다른 컨벤션 규칙이나 서로 다른 포맷터 등을 사용할 경우, 소스코드 관리 시스템에서 다른 팀원의 코드를 pull한 후, 작업을 하고 다시 commit을 할 때,
* 다른 팀원이 작업했던 부분에서 스페이스 공간이 늘어난다던지, 개행이 추가되어 이력에 남는 경우가 있었던 기억이 있을 것이다.
* 이러한 부분때문에 사전에 협업을 들어가기 전에 형식을 맞추는 일은 매우 중요하고, 협업을 했지만 마치 한명이 짠듯한 같은 형식을 유지하게 프로젝트를 진행하는 것은 중요하다!
* 물론 협업에 있어서 뿐만 아니라 이 챕터는 가독성과 깔끔한 코드에 대한 중요성도 말하고 있다.

## 개요
* 프로그래머라면 형식을 깔끔하게 맞춰 코드를 짜야한다. 코드 형식을 맞추기 위한 간단한 규칙을 정하고, 그 규칙을 착실히 따라야 한다.
* 팀으로 일한다면 팀이 합의해 규칙을 정하고 모두가 그 규칙을 따라야 한다. (ex. 규칙을 자동으로 적용하는 도구를 활용)
* 이 두 문장은 개인으로서 코드를 작성할 때와 팀원을 작성할 때의 형식 맞추기에 대한 모든 이야기의 목표를 담고 있는 문장이다.

## 형식을 맞추는 목적
* 코드 형식은 너무 중요하다.
* 단순히 돌아가는 코드만을 개발자의 의무라고 생각한다면, 좋지 않은 생각이다.
* 구현한 기능은 다음 버전에서 바뀔 확률이 높지만, 구현한 코드의 가독성과 코드 스타일은 긴 생명력을 가지고 살아남는다.
* 즉, 개발에 있어서 단순히 기능 구현이 다가 아니라는 말을 하고 있다.
* 이전 회사에서는 빠른 개발이 중요했다. 결국 내 코드가 머지가 되면서도 만족스럽지 못했고, 다른 코드를 받았을 때도 이해하는데 시간이 오래 걸렸다. 내가 이직을 결심하게 된 이유 중 하나였다.

## 신문 기사처럼 작성하자
* 신문은 위에서 아래로 기사를 읽는다.
* 또한, 요약하는 표제가 있고, 첫 문단은 전체 기사 내용을 요약한다.
* 읽어갈수록 세세한 사실과 세부적인 사항이 등장한다.
* 소스파일도 이처럼 작성하자고 책에서 강조한다.
* 이름은 간단하면서도 설명이 가능하도록 짓는다.
* 첫 부분은 고차원 개념을 설명한다.
* 아래로 내려갈수록 세세하게 묘사하며, 마지막에 저차원함수가 나와야 한다.

## 개념은 빈 행으로 분리하라
* 각 행은 수식이나 절을 나타내고, 일련의 행 묶음은 완결된 생각 하나를 표현한다.
* 생각 사이에는 빈 행을 넣어 분리해야 한다.
* 예시 코드는 필요없을 것 같다.
* 하나의 클래스 안에서 인스턴스 변수, 인스턴스 메소드들을 짧은 문단처럼 작성하고, 각 문단에 빈행을 넣는 것처럼 코드에서도 작성한 것과,
* 이 모든 변수, 메소드들을 클래스 사이에 개행없이 나열한 것의 가독성 차이는 천지차이다.

## 세로 밀집도
* 줄바꿈이 개념을 분리한다면, 세로 밀집도는 연관성을 의미한다.
* __즉, 서로 밀접한 코드 행은 세로로 가까이 놓여야 한다는 것이다.__
* 주석이 있는 코드여도 가독성을 좋지않게 하는 것에 대한 좋은 예시이기도 한 예시 코드이다.

```java
public class Person {
  /**
   * 사람 클래스의 이름
   */
  private String name;

  /**
   * 사람 클래스의 나이
   */
  private int age;

  /**
   * 사람 클래스의 키
   */
  private int height;

  public void updateAge() {
    this.age + 1;
  }
}
```

```java
public class Person {
  private String name;
  private int age;
  private int height;

  public void updateAge() {
    this.age += 1;
  }
}
```

* 아래의 클래스가 훨씬 한눈에 들어오고 가독성이 높다.
* 불필요한 주석때문에 가독성이 낮아진다.
* 코드가 간단하기 때문에 아래 코드는 보면 바로 인스턴스 변수 3개에 메소드 1개인 Person 클래스라는 것을 알 수 있다.

## 수직 거리
* 서로 밀접한 개념은 세로로 가까이 둬야한다.
* 같은 파일에 속할 정도로 밀접한 두 개념은 세로 거리를 통해 연관성을 표현한다.
* 연관성이 깊은 두 개념이 멀리 떨어져 있으면, 코드를 읽는 독자는 여기저기를 왔다갔다 해야한다.
* 이전에 인수인계를 하기 위해 받았던 코드 중, 서비스 장애가 발생할 때마다, 분석없이 여기저기 끼워넣어가며 유지보수를 해오던 코드가 있었다.
* 코드 분석을 하면서 A 도메인에 필요한 메소드가 B 도메인안에 있고, 내가 찾으려하는 메소드 역시 다른 도메인에서 발견되어, 연습장에 일일이 코드 위치들을 써가며 분석했던 기억이 있다.
* 이런 코드가 세로 밀집도와 수직 거리의 주제에 벗어나는 코드가 아닐까라는 조심스러운 추측을 해본다.

## 인스턴스 변수
* 인스턴스 변수는 클래스 맨 처음에 선언한다.
* 변수간에 세로로 거리를 두지 않는다.
* C++에서는 가위 규칙을 적용해서 인스턴스 변수를 클래스 마지막에 선언한다고 한다. 처음 알게된 내용이었다.

## 종속 함수
* 한 함수가 다른 함수를 호출한다면, 두 함수는 세로로 가까이 배치한다.
* 또한 가능하다면 호출하는 함수를 호출되는 함수보다 먼저 배치한다.
* 이 부분은 인턴 교육을 받으며 멘토님께 리뷰받았던 내용이다.
* 또한 이책에서 계속 강조하는 책읽듯이 코드가 읽혀야된다고 하는 부분과 일치한다.
* __사람은 위에서 아래로 무언가를 읽기 때문이다.__

## 가로 공백과 밀집도
* 가로로는 공백을 사용해 밀접한 개념과 느슨한 개념을 표현한다.
* 수식을 이에대한 예시로 든 것이 마음에 들었다.

```java
int result = (-b + Math.sqrt(determinant)) / (2*a);
```

* 물론 포맷터를 사용하면 가로 공백이 일정하게 바뀔 것이다.
* 하지만 의도한 내용은 느낄 수 있었다.
* -b를 통해 -와 b의 거리가 가까움을 느낄 수 있었고,
* 항 + 항을 통해 항을 구분할 수 있었다.

## 가로 정렬
* 가끔 코드를 보면, 특정 구조를 강조하고자 가로 정렬을 한 코드들을 많이 볼 수 있다.

```java
public class FitNesseExpediter {
  private     Socket        socket;
  private     InputStream   input;
  protected   long          requestParsingTimeLimit;

  // ...
}
```

* 이런 코드에도 단점이 있다고 책에서 말하고 있다.
* 변수 유형은 무시하고 변수 이름만 보는 경향 등..
* 정렬을 해서 오히려 중대한 결함을 놓칠 수 있다는 이야기이다.

## 정리
* 이전 포스팅과 마찬가지로 내가 지금껏 프로그래밍을 하며 많이 느꼈던 부분 위주로 정리를 하였다.
* 많은 것을 느낄 수 있었던 챕터였던 것 같다.
* 꼭 팀프로젝트나 개인 프로젝트를 할 때는, 협업 규칙 등을 정해서 시작하자!

## 출처
* Clean Code 애자일 소프트웨어 장인 정신 - 로버트 C.마틴